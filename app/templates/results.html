{% extends 'layout.html' %}
{% block title %}Search Results{% endblock %}
{% block content %}
    <h1>Search Results for "{{ query }}"</h1>
    <form action="{{ url_for('main.search') }}" method="POST" class="filters">
        <input type="hidden" name="query" value="{{ query }}">
        <label for="date_filter">Filter by Date:</label>
        <select name="date_filter" id="date_filter">
            <option value="">All</option>
            <option value="today">Today</option>
            <option value="week">This Week</option>
            <option value="month">This Month</option>
        </select>
        <label for="type_filter">Filter by Type:</label>
        <select name="type_filter" id="type_filter">
            <option value="">All</option>
            <option value=".txt">Text (.txt)</option>
            <option value=".csv">CSV (.csv)</option>
            <option value=".json">JSON (.json)</option>
            <option value=".xml">XML (.xml)</option>
            <option value=".tsv">TSV (.tsv)</option>
        </select>
        <button type="submit">Apply Filters</button>
    </form>
    {% if results %}
        <div class="results">
            {% for result in results %}
                <div class="result-item">
                    <h3>{{ result.filename }}</h3>
                    <p>{{ result.snippet | safe }}</p>
                    <a href="{{ url_for('main.download', doc_id=result.doc_id) }}" class="btn">Download</a>
                    <button onclick="showPreview('{{ result.doc_id }}')" class="btn">Preview</button>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No results found for "{{ query }}".</p>
    {% endif %}
    <a href="{{ url_for('main.home') }}" class="btn">Back to Search</a>
    <style>
        .filters {
            margin-bottom: 1rem;
        }
        .filters select, .filters button {
            margin-right: 1rem;
        }
    </style>
{% endblock %}